sudo: required

language: go

go:
  - 1.14

services:
  - docker

before_install:
  - sudo apt-get install jq

script:
  - make unittest

before_deploy:
  - docker login -u "$DOCKER_USERNAME" -p "$DOCKER_PASSWORD"
  - make release

deploy:
- provider: releases
  api_key: 
   secure: "nqTCTPPjo5ok71Sm3lTq/6j/jxSzNBGKmOzLanNvycRkviXoIxmm/JYfBKMLqa+g1wvdq6NH62hrca9EyUlblHcY4MyJbI4NJV/I0qkY5uM4dqKjGRb0a6y12vBW70riQBq0GTAaNYaaGoGmRaJSKecM39WxKCBdRKlYBYZft4JkAy7VfaHZvIcPoKzt0fOjU9l1K9QDuWvu1OhdYnWIp7bqbASnzmWlSTOMhPRrP7MUzDsHFWnhSnVb8CsgKKYsafDTC6VNd/uwqSj7u2L6s8soPcCBcDB0fh0cDrbXjwwva0u5786hLOu6QkZWBDNRRGZiuGdnpUJEUyx+g2KbMKYwKfE21SovDaIvZfeI0GkkR2hYX0trfQ8S6FXW9kyKmkLyV1FVCj15iSgFlCHXNYX2hvBULrvm91c/aCI/17lq6WsW+XE+kQC05rIy1Z16DKyYGOpoLIaCjR2+0wp3CGbYe4W9WLlsV6Sk4JjOyWddsL1AwmL7T7dSb4l7hD6aU5u+es1fTi7E3PjFlXfS1Vx+SNYpAJSJQ6JiaM4tJ6/BwWyS1jx8BdEwJ0n4nMbED+iMttmXWInNww42sE16rKbmUkQaXd7xm4uIIWPYdvu/2LVgHZCUnqRAb7vDSsfov9p9UYmJrrXdyhDwDwt0qu4zXLlmh/QzRL9WU6i4XfA="
    # Encrypted personal access token of `carbon-bot-user` github user
    # Encrypted with `travis encrypt [TOKEN]`
  file: 
   - build/macOS.zip
   - build/Linux.zip
   - build/Windows.zip
  skip_cleanup: true
  on:
    tags: true